# Contaminant Transport Example

## Introduction

This example is from Marina Pantazidou.
- Educational context is described in Pantazidou and Kandris (2020): https://online-journals.org/index.php/i-jep/article/view/11181
- Materials downloaded from this website: http://users.ntua.gr/mpanta/Teaching_EN/EnvironmentalGeotechnics/Supplement_P_K_2019/
- Also related to ISSMGE Peer-Reviewed Educational Materials for Environmental Geotechnics, Contribution 1 (Pantazidou, 2022): https://www.issmge.org/education/peer-reviewed-educational-materials/environmental-geotechnics/contribution-1


Pantazidou, M., & Kandris, K. (2020). Examples of Applying Research-Based Learning Principles to the Redesign of an Environmental Geotechnics Course. International Journal of Engineering Pedagogy (iJEP), 10(1), pp. 31â€“50. https://doi.org/10.3991/ijep.v10i1.11181

Pantazidou and Kandris (2020) and Pantazidou (2022) are licensed under CC BY. The license for the supplement materials "Supplement_P_K_2019" is assumed to be part of Pantazidou and Kandris (2020) and thus also released as CC BY.

## 

## Original Matlab Script

````{admonition} Original Matlab code
:class: tip, dropdown

This is directly from `InstPointSource.m`.

```matlab
% Analytical solution for an instataneous solute release from a point source               
%
%--------------------------------------------------------------------------
M = input('Provide solute mass, M:'); %Mass, [g]
ax= input('Provide longitudinal dispersivity, ax:'); % [m]
ay= input('Provide transversal dispersivity, ay:'); % [m]
az= input('Provide transversal dispersivity, az:'); %[m]
Kp= input('Provide partition coefficient, Kp:'); %[cm^3/g]
lambda= input('Provide decay coefficient, l:'); %[d^-1]
De= 0.6e-4; % molecular diffusion coefficient [m^2/d]
n = 0.33; % porosity
vx= 0.081; % seepage velocity, [m/d]
rd= 1.810; % bulk density of the soil [g/cm^3]
R = 1+((rd*Kp)/n); % Retardation factor
vrx = vx/R;
Dx = (ax*vx+De)/R;
Dy = (ay*vx+De)/R;
Dz = (az*vx+De)/R;
z= 0.0; % depth [m]
t = 160; % time [d]
%------------------------create the flow field-----------------------------
xmin = -20; xmax = 30;              % x-axis interval
ymin = -20; ymax = 30;              % y-axis interval
[x,y] = meshgrid (linspace(xmin,xmax,200),linspace(ymin,ymax,200));
%----------------------calculate concentration, c--------------------------
c=zeros(200,200); %
for i=1:200
    for j=1:200
            c(j,i)= (M/(n*8*((pi()*t)^(3/2))*((Dx*Dy*Dz)^0.5)))*...
            exp((-((x(1,i)-vrx*t)^2)/(4*Dx*t))-(y(j,1)^2/(4*Dy*t))-...
            (z^2/(4*Dz*t))-(lambda*t));
    end
end
%----------------------------------output----------------------------------
c=1000*c; % convert to [g/l]
%----------------------------------figure----------------------------------
% Create figure
figure1 = figure;
% Create axes
axes1 = axes('Parent',figure1,'YGrid','on','XGrid','on','Layer','top');
%% Uncomment the following line to preserve the X-limits of the axes
% xlim(axes1,[-20 30]);
%% Uncomment the following line to preserve the Y-limits of the axes
% ylim(axes1,[-20 30]);
box(axes1,'on');
hold(axes1,'all');
% Create contour
contour(x,y,c,'ShowText','on',...
    'DisplayName','Concentration, c [g/l]',...
    'Parent',axes1);
% Create xlabel
xlabel('X (m)');
% Create ylabel
ylabel('Y (m)');
% Create legend
legend1 = legend(axes1,'show');
set(legend1,'Location','Best');
```

````

## Conversion to Python

This page documents how the Python script on the example page was made by asking GitHub Copilot to convert a Matlab script. The Python code ran without error when tested in a Jupyter notebook. The code and widgets also worked in the Jupyter Book interactive Python environment.

Note that the structure of the code was changed by Copilot based on the fact that the question asked for a Python script that uses `ipywidgets` to create sliders and text entry boxes for the input parameters, a process which is best carried out by writing a function to carry out the analysis for use in the interactive figure: the `interact` function is used to call the `solute_transport` function with the input parameters. The `solute_transport` function calculates the concentration of a solute released from a point source and plots the concentration contours.


This is the question that was asked to GitHub Copilot:
> here is a piece of code written in matlab. can you set up a similar analysis using Python and matplotlib? convert the input statements to piywidet sliders and text entry boxes.

_Note: the Matlab code shown below was also included in the question prompt; typos are apparent in the question but were not a problem for Copilot._

**This Python code can be used interactively on the Example 1 page.**

````{admonition} Python code generated by GitHub Copilot
:class: tip, dropdown

This is the Python code generated by GitHub Copilot.

```python
import numpy as np
import matplotlib.pyplot as plt
import ipywidgets as widgets
from ipywidgets import interact

def solute_transport(M, ax, ay, az, Kp, lambda_):
    De = 0.6e-4  # molecular diffusion coefficient [m^2/d]
    n = 0.33  # porosity
    vx = 0.081  # seepage velocity, [m/d]
    rd = 1.810  # bulk density of the soil [g/cm^3]
    R = 1 + ((rd * Kp) / n)  # Retardation factor
    vrx = vx / R
    Dx = (ax * vx + De) / R
    Dy = (ay * vx + De) / R
    Dz = (az * vx + De) / R
    z = 0.0  # depth [m]
    t = 160  # time [d]
    xmin, xmax = -20, 30
    ymin, ymax = -20, 30
    x, y = np.meshgrid(np.linspace(xmin, xmax, 200), np.linspace(ymin, ymax, 200))
    c = np.zeros((200, 200))
    for i in range(200):
        for j in range(200):
            c[j, i] = (M / (n * 8 * ((np.pi * t) ** (3 / 2)) * ((Dx * Dy * Dz) ** 0.5))) * \
                     np.exp((-(x[0, i] - vrx * t) ** 2 / (4 * Dx * t)) - (y[j, 0] ** 2 / (4 * Dy * t)) - \
                            (z ** 2 / (4 * Dz * t)) - (lambda_ * t))
    c = 1000 * c  # convert to [g/l]
    plt.figure()
    plt.contour(x, y, c, levels=20)
    plt.xlabel('X (m)')
    plt.ylabel('Y (m)')
    plt.title('Concentration, c [g/l]')
    plt.colorbar(label='Concentration [g/l]')
    plt.grid(True)
    plt.show()

M_slider = widgets.FloatSlider(value=1, min=0.1, max=10, step=0.1, description='M [g]:')
ax_slider = widgets.FloatSlider(value=1, min=0.1, max=10, step=0.1, description='ax [m]:')
ay_slider = widgets.FloatSlider(value=1, min=0.1, max=10, step=0.1, description='ay [m]:')
az_slider = widgets.FloatSlider(value=1, min=0.1, max=10, step=0.1, description='az [m]:')
Kp_slider = widgets.FloatSlider(value=1, min=0.1, max=10, step=0.1, description='Kp [cm^3/g]:')
lambda_slider = widgets.FloatSlider(value=0.1, min=0.01, max=1, step=0.01, description='lambda [d^-1]:')

interact(solute_transport, M=M_slider, ax=ax_slider, ay=ay_slider, az=az_slider, Kp=Kp_slider, lambda_=lambda_slider)
```

````
